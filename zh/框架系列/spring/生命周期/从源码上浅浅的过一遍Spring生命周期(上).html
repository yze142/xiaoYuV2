<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.62" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mister-hope.github.io/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html"><meta property="og:site_name" content="博客"><meta property="og:title" content="从源码上浅浅的过一遍Spring生命周期"><meta property="og:description" content="1.扫描流程 一开始我们学习spring都是从new ClassPathXmlApplicationContext("spring.xml");开始，但是随着社会的发展。。。。编不下去了 AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class); //ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("spring.xml"); UserService userService = (UserService) context.getBean("userService"); userService.test();"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-07-07T09:16:15.000Z"><meta property="article:author" content="于子恩"><meta property="article:modified_time" content="2023-07-07T09:16:15.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"从源码上浅浅的过一遍Spring生命周期","image":[""],"dateModified":"2023-07-07T09:16:15.000Z","author":[{"@type":"Person","name":"于子恩"}]}</script><title>从源码上浅浅的过一遍Spring生命周期 | 博客</title><meta name="description" content="1.扫描流程 一开始我们学习spring都是从new ClassPathXmlApplicationContext("spring.xml");开始，但是随着社会的发展。。。。编不下去了 AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class); //ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("spring.xml"); UserService userService = (UserService) context.getBean("userService"); userService.test();">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-cbd167c8.css" as="style"><link rel="stylesheet" href="/assets/style-cbd167c8.css">
    <link rel="modulepreload" href="/assets/app-5f43d021.js"><link rel="modulepreload" href="/assets/从源码上浅浅的过一遍Spring生命周期(上).html-ceb762f5.js"><link rel="modulepreload" href="/assets/从源码上浅浅的过一遍Spring生命周期(上).html-a58215a7.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/assets/intro.html-0808bb89.js" as="script"><link rel="prefetch" href="/assets/index.html-443a0c29.js" as="script"><link rel="prefetch" href="/assets/slides.html-0dd27da2.js" as="script"><link rel="prefetch" href="/assets/disable.html-34fdbb8a.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-6ddebd32.js" as="script"><link rel="prefetch" href="/assets/markdown.html-c984607d.js" as="script"><link rel="prefetch" href="/assets/page.html-f47a972e.js" as="script"><link rel="prefetch" href="/assets/index.html-fdd41348.js" as="script"><link rel="prefetch" href="/assets/cherry.html-6ff3cb36.js" as="script"><link rel="prefetch" href="/assets/dragonfruit.html-c185f326.js" as="script"><link rel="prefetch" href="/assets/strawberry.html-60c78cec.js" as="script"><link rel="prefetch" href="/assets/tomato.html-52d52bbd.js" as="script"><link rel="prefetch" href="/assets/index.html-be2d1974.js" as="script"><link rel="prefetch" href="/assets/1.html-d76480e5.js" as="script"><link rel="prefetch" href="/assets/2.html-fc0c2c45.js" as="script"><link rel="prefetch" href="/assets/3.html-a93f6386.js" as="script"><link rel="prefetch" href="/assets/4.html-0c304b01.js" as="script"><link rel="prefetch" href="/assets/1.html-5cb7b9d3.js" as="script"><link rel="prefetch" href="/assets/2.html-c93caccc.js" as="script"><link rel="prefetch" href="/assets/3.html-0c826833.js" as="script"><link rel="prefetch" href="/assets/4.html-8249d864.js" as="script"><link rel="prefetch" href="/assets/依赖注入@Autowired.html-d32c7b49.js" as="script"><link rel="prefetch" href="/assets/404.html-5a9f6176.js" as="script"><link rel="prefetch" href="/assets/index.html-b1992657.js" as="script"><link rel="prefetch" href="/assets/index.html-4f800127.js" as="script"><link rel="prefetch" href="/assets/index.html-02aee52d.js" as="script"><link rel="prefetch" href="/assets/index.html-eaabcc61.js" as="script"><link rel="prefetch" href="/assets/index.html-32843fc2.js" as="script"><link rel="prefetch" href="/assets/index.html-ac467e82.js" as="script"><link rel="prefetch" href="/assets/index.html-21a0aefa.js" as="script"><link rel="prefetch" href="/assets/index.html-c58e1afa.js" as="script"><link rel="prefetch" href="/assets/index.html-01ded863.js" as="script"><link rel="prefetch" href="/assets/index.html-3605a2e0.js" as="script"><link rel="prefetch" href="/assets/index.html-a1ca7a0d.js" as="script"><link rel="prefetch" href="/assets/index.html-631773c6.js" as="script"><link rel="prefetch" href="/assets/index.html-c341fde1.js" as="script"><link rel="prefetch" href="/assets/index.html-7f4267b3.js" as="script"><link rel="prefetch" href="/assets/index.html-ca73957d.js" as="script"><link rel="prefetch" href="/assets/index.html-99cf7aa4.js" as="script"><link rel="prefetch" href="/assets/index.html-87256ae5.js" as="script"><link rel="prefetch" href="/assets/index.html-ff13b77e.js" as="script"><link rel="prefetch" href="/assets/index.html-379885f3.js" as="script"><link rel="prefetch" href="/assets/index.html-d3d109ad.js" as="script"><link rel="prefetch" href="/assets/index.html-0722b3d6.js" as="script"><link rel="prefetch" href="/assets/index.html-af9c3427.js" as="script"><link rel="prefetch" href="/assets/index.html-5b3b47ca.js" as="script"><link rel="prefetch" href="/assets/index.html-6c92b95e.js" as="script"><link rel="prefetch" href="/assets/index.html-d12eaff5.js" as="script"><link rel="prefetch" href="/assets/index.html-f9cbaa54.js" as="script"><link rel="prefetch" href="/assets/index.html-7c363984.js" as="script"><link rel="prefetch" href="/assets/index.html-9d179334.js" as="script"><link rel="prefetch" href="/assets/index.html-aa854059.js" as="script"><link rel="prefetch" href="/assets/index.html-bf307c9d.js" as="script"><link rel="prefetch" href="/assets/index.html-6989f6cd.js" as="script"><link rel="prefetch" href="/assets/index.html-d220e3d3.js" as="script"><link rel="prefetch" href="/assets/index.html-9ae73ca3.js" as="script"><link rel="prefetch" href="/assets/index.html-13328f4a.js" as="script"><link rel="prefetch" href="/assets/index.html-0d158445.js" as="script"><link rel="prefetch" href="/assets/index.html-c0d8cb32.js" as="script"><link rel="prefetch" href="/assets/index.html-8a26b061.js" as="script"><link rel="prefetch" href="/assets/intro.html-71f1a1d7.js" as="script"><link rel="prefetch" href="/assets/index.html-d2ce71e9.js" as="script"><link rel="prefetch" href="/assets/slides.html-0bad3e4f.js" as="script"><link rel="prefetch" href="/assets/disable.html-f181516c.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-9221799d.js" as="script"><link rel="prefetch" href="/assets/markdown.html-e5b94dbd.js" as="script"><link rel="prefetch" href="/assets/page.html-ba1b5b42.js" as="script"><link rel="prefetch" href="/assets/index.html-f4130fca.js" as="script"><link rel="prefetch" href="/assets/cherry.html-05d02f25.js" as="script"><link rel="prefetch" href="/assets/dragonfruit.html-8396344f.js" as="script"><link rel="prefetch" href="/assets/strawberry.html-13be42ce.js" as="script"><link rel="prefetch" href="/assets/tomato.html-f9cb9ca4.js" as="script"><link rel="prefetch" href="/assets/index.html-45526ef7.js" as="script"><link rel="prefetch" href="/assets/1.html-25acdd51.js" as="script"><link rel="prefetch" href="/assets/2.html-0dd84b3c.js" as="script"><link rel="prefetch" href="/assets/3.html-d14718e0.js" as="script"><link rel="prefetch" href="/assets/4.html-94aeed16.js" as="script"><link rel="prefetch" href="/assets/1.html-f1d92188.js" as="script"><link rel="prefetch" href="/assets/2.html-1c1ad181.js" as="script"><link rel="prefetch" href="/assets/3.html-8164d753.js" as="script"><link rel="prefetch" href="/assets/4.html-e52bca35.js" as="script"><link rel="prefetch" href="/assets/依赖注入@Autowired.html-99b400a3.js" as="script"><link rel="prefetch" href="/assets/404.html-6bbd3dc3.js" as="script"><link rel="prefetch" href="/assets/index.html-e183c6d4.js" as="script"><link rel="prefetch" href="/assets/index.html-b92d9731.js" as="script"><link rel="prefetch" href="/assets/index.html-f313d943.js" as="script"><link rel="prefetch" href="/assets/index.html-5fa025c6.js" as="script"><link rel="prefetch" href="/assets/index.html-db4222a7.js" as="script"><link rel="prefetch" href="/assets/index.html-2aa76b8f.js" as="script"><link rel="prefetch" href="/assets/index.html-4bd79136.js" as="script"><link rel="prefetch" href="/assets/index.html-d3d20b0c.js" as="script"><link rel="prefetch" href="/assets/index.html-d4103b88.js" as="script"><link rel="prefetch" href="/assets/index.html-df5190c0.js" as="script"><link rel="prefetch" href="/assets/index.html-941073fb.js" as="script"><link rel="prefetch" href="/assets/index.html-366b7536.js" as="script"><link rel="prefetch" href="/assets/index.html-0feaf2a1.js" as="script"><link rel="prefetch" href="/assets/index.html-4b2ab129.js" as="script"><link rel="prefetch" href="/assets/index.html-4938668e.js" as="script"><link rel="prefetch" href="/assets/index.html-55e2b8ba.js" as="script"><link rel="prefetch" href="/assets/index.html-027b5c7c.js" as="script"><link rel="prefetch" href="/assets/index.html-f944abc0.js" as="script"><link rel="prefetch" href="/assets/index.html-49384ff7.js" as="script"><link rel="prefetch" href="/assets/index.html-1e87e88c.js" as="script"><link rel="prefetch" href="/assets/index.html-6d53da49.js" as="script"><link rel="prefetch" href="/assets/index.html-b64c54d9.js" as="script"><link rel="prefetch" href="/assets/index.html-6763967d.js" as="script"><link rel="prefetch" href="/assets/index.html-6aa93bad.js" as="script"><link rel="prefetch" href="/assets/index.html-bb63a357.js" as="script"><link rel="prefetch" href="/assets/index.html-2c7375b6.js" as="script"><link rel="prefetch" href="/assets/index.html-84319a05.js" as="script"><link rel="prefetch" href="/assets/index.html-174f4ba5.js" as="script"><link rel="prefetch" href="/assets/index.html-bf553a13.js" as="script"><link rel="prefetch" href="/assets/index.html-0749de02.js" as="script"><link rel="prefetch" href="/assets/index.html-3323e6ca.js" as="script"><link rel="prefetch" href="/assets/index.html-4cda6f0d.js" as="script"><link rel="prefetch" href="/assets/index.html-a9fca45c.js" as="script"><link rel="prefetch" href="/assets/index.html-13bd4fe3.js" as="script"><link rel="prefetch" href="/assets/index.html-e9870ad3.js" as="script"><link rel="prefetch" href="/assets/index.html-108ecdf1.js" as="script"><link rel="prefetch" href="/assets/index.html-b6094a9e.js" as="script"><link rel="prefetch" href="/assets/giscus-765fdce2.js" as="script"><link rel="prefetch" href="/assets/auto-fa8841cf.js" as="script"><link rel="prefetch" href="/assets/index-ae8c1e74.js" as="script"><link rel="prefetch" href="/assets/flowchart-d65a1d8e.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-4369488e.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-0191f9da.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-ec5549c1.js" as="script"><link rel="prefetch" href="/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-335b384a.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-5794cde2.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header class="vp-navbar" id="navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/zh/" class="vp-brand"><img class="vp-nav-logo" src="/机器猫.png" alt="博客"><!----><span class="vp-site-name hide-in-pad">博客</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a href="/zh/" class="nav-link" aria-label="博客主页"><span class="font-icon icon iconfont icon-home" style=""></span>博客主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/" class="nav-link active" aria-label="框架"><span class="font-icon icon iconfont icon-Apache" style=""></span>框架<!----></a></div><div class="nav-item hide-in-mobile"><a href="/zh/database/" class="nav-link" aria-label="数据库"><span class="font-icon icon iconfont icon-delete" style=""></span>数据库<!----></a></div><div class="nav-item hide-in-mobile"><a href="/zh/programming/" class="nav-link" aria-label="编程语言"><span class="font-icon icon iconfont icon-java" style=""></span>编程语言<!----></a></div><div class="nav-item hide-in-mobile"><a href="/zh/multithreading/" class="nav-link" aria-label="多线程"><span class="font-icon icon iconfont icon-launch" style=""></span>多线程<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button type="button" class="dropdown-title" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/" class="nav-link" aria-label="English"><!---->English<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html" class="router-link-active router-link-exact-active nav-link active" aria-label="简体中文"><!---->简体中文<!----></a></li></ul></button></div></div><div class="nav-item"><a class="vp-repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/zh/" class="nav-link sidebar-link sidebar-page" aria-label="博客主页"><span class="font-icon icon iconfont icon-home" style=""></span>博客主页<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><!----><span class="title">框架系列</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><!----><span class="title">Spring</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><!----><span class="title">生命周期</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="从源码上浅浅的过一遍Spring生命周期"><span class="font-icon icon iconfont icon-page" style=""></span>从源码上浅浅的过一遍Spring生命周期<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#_1-扫描流程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.扫描流程"><!---->1.扫描流程<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#生成beandefinition" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="生成BeanDefinition"><!---->生成BeanDefinition<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#classpathbeandefinitionscanner-doscan方法源码" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ClassPathBeanDefinitionScanner.doScan方法源码"><!---->ClassPathBeanDefinitionScanner.doScan方法源码<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#classpathscanningcandidatecomponentprovider-scancandidatecomponents源码" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ClassPathScanningCandidateComponentProvider.scanCandidateComponents源码"><!---->ClassPathScanningCandidateComponentProvider.scanCandidateComponents源码<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#_2-合并beandefinition为rootbeandefinition" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.合并BeanDefinition为RootBeanDefinition"><!---->2.合并BeanDefinition为RootBeanDefinition<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#abstractbeanfactory-getmergedbeandefinition" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="AbstractBeanFactory.getMergedBeanDefinition"><!---->AbstractBeanFactory.getMergedBeanDefinition<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label><!----><!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#_3-实例化非懒加载的单例bean" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.实例化非懒加载的单例Bean"><!---->3.实例化非懒加载的单例Bean<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#abstractbeanfactory-getbean方法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="AbstractBeanFactory.getBean方法"><!---->AbstractBeanFactory.getBean方法<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#createbean-加载类" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="createBean&amp;加载类"><!---->createBean&amp;加载类<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#实例化前" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="实例化前"><!---->实例化前<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#实例化" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="实例化"><!---->实例化<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#实例化后" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="实例化后"><!---->实例化后<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#_4-属性赋值" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.属性赋值"><!---->4.属性赋值<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#spring中过时的bean注入方式" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="spring中过时的Bean注入方式"><!---->spring中过时的Bean注入方式<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label><!----><!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#依赖注入" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="依赖注入"><!---->依赖注入<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#_5-bean的初始化" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.Bean的初始化"><!---->5.Bean的初始化<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#初始化前" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="初始化前"><!---->初始化前<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#初始化" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="初始化"><!---->初始化<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#初始化后" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="初始化后"><!---->初始化后<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#总结beanpostprocessor" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="总结BeanPostProcessor"><!---->总结BeanPostProcessor<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">注入过程</span><span class="arrow end"></span></button><!----></section></li></ul></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="vp-page" id="main-content"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon iconfont icon-page" style=""></span>从源码上浅浅的过一遍Spring生命周期</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">于子恩</span></span><span property="author" content="于子恩"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-07-07T09:16:15.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 11 分钟</span><meta property="timeRequired" content="PT11M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#_1-扫描流程" class="router-link-active router-link-exact-active toc-link level2">1.扫描流程</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#生成beandefinition" class="router-link-active router-link-exact-active toc-link level3">生成BeanDefinition</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#classpathbeandefinitionscanner-doscan方法源码" class="router-link-active router-link-exact-active toc-link level3">ClassPathBeanDefinitionScanner.doScan方法源码</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#classpathscanningcandidatecomponentprovider-scancandidatecomponents源码" class="router-link-active router-link-exact-active toc-link level3">ClassPathScanningCandidateComponentProvider.scanCandidateComponents源码</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#_2-合并beandefinition为rootbeandefinition" class="router-link-active router-link-exact-active toc-link level2">2.合并BeanDefinition为RootBeanDefinition</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#abstractbeanfactory-getmergedbeandefinition" class="router-link-active router-link-exact-active toc-link level3">AbstractBeanFactory.getMergedBeanDefinition</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#" class="router-link-active router-link-exact-active toc-link level3"></a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#_3-实例化非懒加载的单例bean" class="router-link-active router-link-exact-active toc-link level2">3.实例化非懒加载的单例Bean</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#abstractbeanfactory-getbean方法" class="router-link-active router-link-exact-active toc-link level3">AbstractBeanFactory.getBean方法</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#createbean-加载类" class="router-link-active router-link-exact-active toc-link level3">createBean&amp;加载类</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#实例化前" class="router-link-active router-link-exact-active toc-link level3">实例化前</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#实例化" class="router-link-active router-link-exact-active toc-link level3">实例化</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#实例化后" class="router-link-active router-link-exact-active toc-link level3">实例化后</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#_4-属性赋值" class="router-link-active router-link-exact-active toc-link level2">4.属性赋值</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#spring中过时的bean注入方式" class="router-link-active router-link-exact-active toc-link level3">spring中过时的Bean注入方式</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#-1" class="router-link-active router-link-exact-active toc-link level3"></a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#依赖注入" class="router-link-active router-link-exact-active toc-link level3">依赖注入</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#_5-bean的初始化" class="router-link-active router-link-exact-active toc-link level2">5.Bean的初始化</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#初始化前" class="router-link-active router-link-exact-active toc-link level3">初始化前</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#初始化" class="router-link-active router-link-exact-active toc-link level3">初始化</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#初始化后" class="router-link-active router-link-exact-active toc-link level3">初始化后</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/spring/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%8A%E6%B5%85%E6%B5%85%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8DSpring%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E4%B8%8A).html#总结beanpostprocessor" class="router-link-active router-link-exact-active toc-link level3">总结BeanPostProcessor</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h2 id="_1-扫描流程" tabindex="-1"><a class="header-anchor" href="#_1-扫描流程" aria-hidden="true">#</a> 1.扫描流程</h2><p>一开始我们学习spring都是从new ClassPathXmlApplicationContext(&quot;spring.xml&quot;);开始，但是随着社会的发展。。。。编不下去了</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token class-name">AnnotationConfigApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">AppConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;);</span>
 <span class="token class-name">UserService</span> userService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 userService<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>AnnotationConfigApplicationContext和ClassPathXmlApplicationContext效果都一样，但是前者需要传递一个Class对象</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.xiaoyu&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="生成beandefinition" tabindex="-1"><a class="header-anchor" href="#生成beandefinition" aria-hidden="true">#</a> <strong>生成BeanDefinition</strong></h3><h3 id="classpathbeandefinitionscanner-doscan方法源码" tabindex="-1"><a class="header-anchor" href="#classpathbeandefinitionscanner-doscan方法源码" aria-hidden="true">#</a> <strong>ClassPathBeanDefinitionScanner.doScan方法源码</strong></h3><p>1.首先findCandidateComponents扫描所有的bean存储到BeanDefinitionHolder中。</p><p>2.通过MetadataReaderFactory解析注解信息类的名字，作用域等信息</p><p>3.检查是否有重复的bean如果有，就抛异常</p><p>4.通过DefaultListableBeanFactory.registerBeanDefinition方法真正的把beanDefinition注册到<strong>Spring容器 beanDefinitionMap 中</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanDefinitionHolder</span><span class="token punctuation">&gt;</span></span> <span class="token function">doScan</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> basePackages<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanDefinitionHolder</span><span class="token punctuation">&gt;</span></span> beanDefinitions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> basePackage <span class="token operator">:</span> basePackages<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">//这一步是得到 BeanDefinition</span>
			<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanDefinition</span><span class="token punctuation">&gt;</span></span> candidates <span class="token operator">=</span> <span class="token function">findCandidateComponents</span><span class="token punctuation">(</span>basePackage<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">BeanDefinition</span> candidate <span class="token operator">:</span> candidates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token class-name">ScopeMetadata</span> scopeMetadata <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scopeMetadataResolver<span class="token punctuation">.</span><span class="token function">resolveScopeMetadata</span><span class="token punctuation">(</span>candidate<span class="token punctuation">)</span><span class="token punctuation">;</span>
				candidate<span class="token punctuation">.</span><span class="token function">setScope</span><span class="token punctuation">(</span>scopeMetadata<span class="token punctuation">.</span><span class="token function">getScopeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token class-name">String</span> beanName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>beanNameGenerator<span class="token punctuation">.</span><span class="token function">generateBeanName</span><span class="token punctuation">(</span>candidate<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>candidate <span class="token keyword">instanceof</span> <span class="token class-name">AbstractBeanDefinition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">postProcessBeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AbstractBeanDefinition</span><span class="token punctuation">)</span> candidate<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>candidate <span class="token keyword">instanceof</span> <span class="token class-name">AnnotatedBeanDefinition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 解析@Lazy、@Primary、@DependsOn、@Role、@Description</span>
					<span class="token class-name">AnnotationConfigUtils</span><span class="token punctuation">.</span><span class="token function">processCommonDefinitionAnnotations</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AnnotatedBeanDefinition</span><span class="token punctuation">)</span> candidate<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token comment">// 检查Spring容器中是否已经存在该beanName</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkCandidate</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> candidate<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token class-name">BeanDefinitionHolder</span> definitionHolder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinitionHolder</span><span class="token punctuation">(</span>candidate<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
					definitionHolder <span class="token operator">=</span>
							<span class="token class-name">AnnotationConfigUtils</span><span class="token punctuation">.</span><span class="token function">applyScopedProxyMode</span><span class="token punctuation">(</span>scopeMetadata<span class="token punctuation">,</span> definitionHolder<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
					beanDefinitions<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>definitionHolder<span class="token punctuation">)</span><span class="token punctuation">;</span>

					<span class="token comment">// 注册</span>
					<span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span>definitionHolder<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> beanDefinitions<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="classpathscanningcandidatecomponentprovider-scancandidatecomponents源码" tabindex="-1"><a class="header-anchor" href="#classpathscanningcandidatecomponentprovider-scancandidatecomponents源码" aria-hidden="true">#</a> <strong>ClassPathScanningCandidateComponentProvider.scanCandidateComponents源码</strong></h3><p>这一步获取包下的所有class文件，解析注解信息。<strong>ExcludeFilter</strong>表示排除过滤器，<strong>IncludeFilter</strong>表示包含过滤器。会判断@Component上的信息是否符合includeFilters符合才add进BeanDefinition。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanDefinition</span><span class="token punctuation">&gt;</span></span> <span class="token function">scanCandidateComponents</span><span class="token punctuation">(</span><span class="token class-name">String</span> basePackage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanDefinition</span><span class="token punctuation">&gt;</span></span> candidates <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token comment">// 获取basePackage下所有的文件资源</span>
			<span class="token class-name">String</span> packageSearchPath <span class="token operator">=</span> <span class="token class-name">ResourcePatternResolver</span><span class="token punctuation">.</span><span class="token constant">CLASSPATH_ALL_URL_PREFIX</span> <span class="token operator">+</span>
					<span class="token function">resolveBasePackage</span><span class="token punctuation">(</span>basePackage<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">&#39;/&#39;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourcePattern<span class="token punctuation">;</span>

			<span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> resources <span class="token operator">=</span> <span class="token function">getResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>packageSearchPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Resource</span> resource <span class="token operator">:</span> resources<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>resource<span class="token punctuation">.</span><span class="token function">isReadable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token comment">//通过ASM技术获取元数据</span>
					<span class="token class-name">MetadataReader</span> metadataReader <span class="token operator">=</span> <span class="token function">getMetadataReaderFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMetadataReader</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token comment">// excludeFilters、includeFilters判断</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isCandidateComponent</span><span class="token punctuation">(</span>metadataReader<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// @Component--&gt;includeFilters判断</span>
						<span class="token class-name">ScannedGenericBeanDefinition</span> sbd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScannedGenericBeanDefinition</span><span class="token punctuation">(</span>metadataReader<span class="token punctuation">)</span><span class="token punctuation">;</span>
						sbd<span class="token punctuation">.</span><span class="token function">setSource</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token comment">//第二次判断，是否是接口，抽象类，内部类</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isCandidateComponent</span><span class="token punctuation">(</span>sbd<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">if</span> <span class="token punctuation">(</span>debugEnabled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
								logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Identified candidate component class: &quot;</span> <span class="token operator">+</span> resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span>
								candidates<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
								
		<span class="token keyword">return</span> candidates<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-合并beandefinition为rootbeandefinition" tabindex="-1"><a class="header-anchor" href="#_2-合并beandefinition为rootbeandefinition" aria-hidden="true">#</a> 2.合并BeanDefinition为RootBeanDefinition</h2><h3 id="abstractbeanfactory-getmergedbeandefinition" tabindex="-1"><a class="header-anchor" href="#abstractbeanfactory-getmergedbeandefinition" aria-hidden="true">#</a> <strong>AbstractBeanFactory.getMergedBeanDefinition</strong></h3><p><strong>它是Spring进行bean配置处理的一个关键步骤,用于保证不论bean定义出现在何处,Spring都能够获得其完整配置并准确实例化bean。</strong></p><p>这个方法主要是获取一个bean的合并后配置信息。什么是合并后配置信息?</p><p>在Spring中,bean的配置信息可以出现在多个地方,比如:- 多个XML配置文件 - Java注解 - JavaConfig类 - 之前定义的bean作为parent等Spring需要将这些来自不同地方的bean配置信息进行合并,得到一个唯一的、完整的配置信息对象,以供接下来的bean实例化等操作使用。getMergedBeanDefinition方法的作用就是提供这一合并功能。 - 通过注解指定的配置 - JavaConfig类中的配置 - 父bean的配置(如果指定了parent属性)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">RootBeanDefinition</span> <span class="token function">getMergedBeanDefinition</span><span class="token punctuation">(</span>
			<span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span> bd<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">BeanDefinition</span> containingBd<span class="token punctuation">)</span>
			<span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span> <span class="token punctuation">{</span>

		<span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mergedBeanDefinitions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">RootBeanDefinition</span> mbd <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
			<span class="token class-name">RootBeanDefinition</span> previous <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

			<span class="token comment">// Check with full lock now in order to enforce the same merged instance.</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>containingBd <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				mbd <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mergedBeanDefinitions<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>mbd <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> mbd<span class="token punctuation">.</span>stale<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				previous <span class="token operator">=</span> mbd<span class="token punctuation">;</span>
				<span class="token comment">//这一步如果没有设置Parentsh属性那就拷贝一份BeanDefinition到RootBeanDefinition</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>bd<span class="token punctuation">.</span><span class="token function">getParentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// Use copy of given root bean definition.</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>bd <span class="token keyword">instanceof</span> <span class="token class-name">RootBeanDefinition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						mbd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">RootBeanDefinition</span><span class="token punctuation">)</span> bd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cloneBeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">else</span> <span class="token punctuation">{</span>
						mbd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RootBeanDefinition</span><span class="token punctuation">(</span>bd<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token comment">// Child bean definition: needs to be merged with parent.</span>
					<span class="token comment">// pbd表示parentBeanDefinition</span>
					<span class="token class-name">BeanDefinition</span> pbd<span class="token punctuation">;</span>
					<span class="token keyword">try</span> <span class="token punctuation">{</span>
						<span class="token class-name">String</span> parentBeanName <span class="token operator">=</span> <span class="token function">transformedBeanName</span><span class="token punctuation">(</span>bd<span class="token punctuation">.</span><span class="token function">getParentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>beanName<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>parentBeanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							pbd <span class="token operator">=</span> <span class="token function">getMergedBeanDefinition</span><span class="token punctuation">(</span>parentBeanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
						<span class="token keyword">else</span> <span class="token punctuation">{</span>
							<span class="token class-name">BeanFactory</span> parent <span class="token operator">=</span> <span class="token function">getParentBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token keyword">instanceof</span> <span class="token class-name">ConfigurableBeanFactory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
								pbd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableBeanFactory</span><span class="token punctuation">)</span> parent<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMergedBeanDefinition</span><span class="token punctuation">(</span>parentBeanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span>
							<span class="token comment">//省略代码</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
					<span class="token comment">// Deep copy with overridden values.</span>
					<span class="token comment">// 子BeanDefinition的属性覆盖父BeanDefinition的属性，这就是合并</span>
					mbd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RootBeanDefinition</span><span class="token punctuation">(</span>pbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
					mbd<span class="token punctuation">.</span><span class="token function">overrideFrom</span><span class="token punctuation">(</span>bd<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
                <span class="token comment">//省略代码</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>containingBd <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isCacheBeanMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>mergedBeanDefinitions<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>previous <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">copyRelevantMergedBeanDefinitionCaches</span><span class="token punctuation">(</span>previous<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> mbd<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="" tabindex="-1"><a class="header-anchor" href="#" aria-hidden="true">#</a></h3><h2 id="_3-实例化非懒加载的单例bean" tabindex="-1"><a class="header-anchor" href="#_3-实例化非懒加载的单例bean" aria-hidden="true">#</a> 3.实例化非懒加载的单例Bean</h2><p><strong>DefaultListableBeanFactory.preInstantiateSingletons()</strong></p><p>1.遍历beanNames集合，this.beanDefinitionNames存放了所有beanNames。</p><p>2.判断是否FactoryBean获取调用getObject时机。</p><p>3.创建Bean对象。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">preInstantiateSingletons</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> beanNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>beanDefinitionNames<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// Trigger initialization of all non-lazy singleton beans...</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> beanName <span class="token operator">:</span> beanNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 获取合并后的BeanDefinition</span>
			<span class="token class-name">RootBeanDefinition</span> bd <span class="token operator">=</span> <span class="token function">getMergedLocalBeanDefinition</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>bd<span class="token punctuation">.</span><span class="token function">isAbstract</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> bd<span class="token punctuation">.</span><span class="token function">isSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>bd<span class="token punctuation">.</span><span class="token function">isLazyInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isFactoryBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 获取FactoryBean对象</span>
					<span class="token class-name">Object</span> bean <span class="token operator">=</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token constant">FACTORY_BEAN_PREFIX</span> <span class="token operator">+</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">FactoryBean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token class-name">FactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> factory <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">FactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> bean<span class="token punctuation">;</span>
						<span class="token keyword">boolean</span> isEagerInit<span class="token punctuation">;</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> factory <span class="token keyword">instanceof</span> <span class="token class-name">SmartFactoryBean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							isEagerInit <span class="token operator">=</span> <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span>
									<span class="token punctuation">(</span><span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">SmartFactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> factory<span class="token punctuation">)</span><span class="token operator">::</span><span class="token function">isEagerInit</span><span class="token punctuation">,</span>
									<span class="token function">getAccessControlContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
						<span class="token keyword">else</span> <span class="token punctuation">{</span>
							<span class="token comment">//SmartFactoryBean这个接口中有个isEagerInit方法，如果实现了这个方法并且返回true的话就直接调用getObject</span>
							isEagerInit <span class="token operator">=</span> <span class="token punctuation">(</span>factory <span class="token keyword">instanceof</span> <span class="token class-name">SmartFactoryBean</span> <span class="token operator">&amp;&amp;</span>
									<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">SmartFactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> factory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEagerInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>isEagerInit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token comment">// 创建真正的Bean对象(getObject()返回的对象)</span>
							<span class="token function">getBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token comment">// 创建Bean对象</span>
					<span class="token function">getBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 所有的非懒加载单例Bean都创建完了后</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> beanName <span class="token operator">:</span> beanNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">//getSingleton单例池里面拿取单例bean</span>
			<span class="token class-name">Object</span> singletonInstance <span class="token operator">=</span> <span class="token function">getSingleton</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>singletonInstance <span class="token keyword">instanceof</span> <span class="token class-name">SmartInitializingSingleton</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token class-name">StartupStep</span> smartInitialize <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getApplicationStartup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token string">&quot;spring.beans.smart-initialize&quot;</span><span class="token punctuation">)</span>
						<span class="token punctuation">.</span><span class="token function">tag</span><span class="token punctuation">(</span><span class="token string">&quot;beanName&quot;</span><span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token class-name">SmartInitializingSingleton</span> smartSingleton <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SmartInitializingSingleton</span><span class="token punctuation">)</span> singletonInstance<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
						smartSingleton<span class="token punctuation">.</span><span class="token function">afterSingletonsInstantiated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">getAccessControlContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token punctuation">{</span>
					smartSingleton<span class="token punctuation">.</span><span class="token function">afterSingletonsInstantiated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				smartInitialize<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>isFactoryBean</strong>方法作用：</p><p>-主要是判断一个bean是否是FactoryBean以判断调用getObject的时机。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isFactoryBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchBeanDefinitionException</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> beanName <span class="token operator">=</span> <span class="token function">transformedBeanName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Object</span> beanInstance <span class="token operator">=</span> <span class="token function">getSingleton</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>beanInstance <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span>beanInstance <span class="token keyword">instanceof</span> <span class="token class-name">FactoryBean</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// No singleton instance found -&gt; check bean definition.</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">containsBeanDefinition</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getParentBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">ConfigurableBeanFactory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// No bean definition found in this factory -&gt; delegate to parent.</span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableBeanFactory</span><span class="token punctuation">)</span> <span class="token function">getParentBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isFactoryBean</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token function">isFactoryBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> <span class="token function">getMergedLocalBeanDefinition</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="abstractbeanfactory-getbean方法" tabindex="-1"><a class="header-anchor" href="#abstractbeanfactory-getbean方法" aria-hidden="true">#</a> AbstractBeanFactory.getBean方法</h3><p>1.这个方法里面主要就是根据不同的作用域创建不同的bean。</p><p>2.有意思的是@dependsOn（BeanName）注解r如果你的bean上面有这个注解并且声明了其他bean的名字，那么会首先创建你声明的beanName，如果出现循环依赖那就会报错，这里spring是没有解决的。</p><p>3.除去上面三种常见的bean外还有一种自定义作用域的bean比如mvc常用的request，根据自定义作用域创建的bean会通过attributes.setAttribute方法缓存起来。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">doGetBean</span><span class="token punctuation">(</span>
			<span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> requiredType<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> <span class="token keyword">boolean</span> typeCheckOnly<span class="token punctuation">)</span>
			<span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>

		<span class="token comment">// name有可能是 &amp;xxx 或者 xxx，如果name是&amp;xxx，那么beanName就是xxx</span>
		<span class="token comment">// name有可能传入进来的是别名，那么beanName就是id</span>
		<span class="token class-name">String</span> beanName <span class="token operator">=</span> <span class="token function">transformedBeanName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Object</span> beanInstance<span class="token punctuation">;</span>

		<span class="token comment">// Eagerly check singleton cache for manually registered singletons.</span>
		<span class="token class-name">Object</span> sharedInstance <span class="token operator">=</span> <span class="token function">getSingleton</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>sharedInstance <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> args <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isSingletonCurrentlyInCreation</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">&quot;Returning eagerly cached instance of singleton bean &#39;&quot;</span> <span class="token operator">+</span> beanName <span class="token operator">+</span>
							<span class="token string">&quot;&#39; that is not fully initialized yet - a consequence of a circular reference&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token punctuation">{</span>
					logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">&quot;Returning cached instance of singleton bean &#39;&quot;</span> <span class="token operator">+</span> beanName <span class="token operator">+</span> <span class="token string">&quot;&#39;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//getObjectForBeanInstance这一步很有意思，可能创建出来的每一个Bean都是Factory，所以这一步就是调用getObject(),</span>
			<span class="token comment">// 如果传入进来的是getBean(&amp;name)那么获取到的就是BeanFactory本身。</span>
			beanInstance <span class="token operator">=</span> <span class="token function">getObjectForBeanInstance</span><span class="token punctuation">(</span>sharedInstance<span class="token punctuation">,</span> name<span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
			<span class="token comment">//根据getSingleton(beanName);没有拿到，那么就自己创建呗</span>
		<span class="token keyword">else</span> <span class="token punctuation">{</span>
			

			<span class="token comment">// Check if bean definition exists in this factory.</span>
			<span class="token class-name">BeanFactory</span> parentBeanFactory <span class="token operator">=</span> <span class="token function">getParentBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//如果没有这个Bean定义就去父beanFactory拿</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>parentBeanFactory <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">containsBeanDefinition</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// Not found -&gt; check parent.</span>
				<span class="token comment">// &amp;&amp;&amp;&amp;xxx----&gt;&amp;xxx</span>
				<span class="token class-name">String</span> nameToLookup <span class="token operator">=</span> <span class="token function">originalBeanName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>parentBeanFactory <span class="token keyword">instanceof</span> <span class="token class-name">AbstractBeanFactory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AbstractBeanFactory</span><span class="token punctuation">)</span> parentBeanFactory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doGetBean</span><span class="token punctuation">(</span>
							nameToLookup<span class="token punctuation">,</span> requiredType<span class="token punctuation">,</span> args<span class="token punctuation">,</span> typeCheckOnly<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				
			<span class="token punctuation">}</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>typeCheckOnly<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">markBeanAsCreated</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token class-name">StartupStep</span> beanCreation <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>applicationStartup<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token string">&quot;spring.beans.instantiate&quot;</span><span class="token punctuation">)</span>
					<span class="token punctuation">.</span><span class="token function">tag</span><span class="token punctuation">(</span><span class="token string">&quot;beanName&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">try</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>requiredType <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					beanCreation<span class="token punctuation">.</span><span class="token function">tag</span><span class="token punctuation">(</span><span class="token string">&quot;beanType&quot;</span><span class="token punctuation">,</span> requiredType<span class="token operator">::</span><span class="token function">toString</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token class-name">RootBeanDefinition</span> mbd <span class="token operator">=</span> <span class="token function">getMergedLocalBeanDefinition</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">// 检查BeanDefinition是不是Abstract的</span>
				<span class="token function">checkMergedBeanDefinition</span><span class="token punctuation">(</span>mbd<span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">// Guarantee initialization of beans that the current bean depends on.</span>
				<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dependsOn <span class="token operator">=</span> mbd<span class="token punctuation">.</span><span class="token function">getDependsOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>dependsOn <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// dependsOn表示当前beanName所依赖的，当前Bean创建之前dependsOn所依赖的Bean必须已经创建好了</span>
					<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> dep <span class="token operator">:</span> dependsOn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token comment">// beanName是不是被dep依赖了，如果是则出现了循环依赖</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDependent</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> dep<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanCreationException</span><span class="token punctuation">(</span>mbd<span class="token punctuation">.</span><span class="token function">getResourceDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">,</span>
									<span class="token string">&quot;Circular depends-on relationship between &#39;&quot;</span> <span class="token operator">+</span> beanName <span class="token operator">+</span> <span class="token string">&quot;&#39; and &#39;&quot;</span> <span class="token operator">+</span> dep <span class="token operator">+</span> <span class="token string">&quot;&#39;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
						<span class="token comment">// dep被beanName依赖了，存入dependentBeanMap中，dep为key，beanName为value</span>
						<span class="token function">registerDependentBean</span><span class="token punctuation">(</span>dep<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>

						<span class="token comment">// 创建所依赖的bean</span>
						<span class="token keyword">try</span> <span class="token punctuation">{</span>
							<span class="token function">getBean</span><span class="token punctuation">(</span>dep<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
						<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchBeanDefinitionException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanCreationException</span><span class="token punctuation">(</span>mbd<span class="token punctuation">.</span><span class="token function">getResourceDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">,</span>
									<span class="token string">&quot;&#39;&quot;</span> <span class="token operator">+</span> beanName <span class="token operator">+</span> <span class="token string">&quot;&#39; depends on missing bean &#39;&quot;</span> <span class="token operator">+</span> dep <span class="token operator">+</span> <span class="token string">&quot;&#39;&quot;</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>

				<span class="token comment">// 实例化创建Bean</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>mbd<span class="token punctuation">.</span><span class="token function">isSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">//如果单例池能获取到bean那就直接创建，否则调用lambda表达式创建bean</span>
					sharedInstance <span class="token operator">=</span> <span class="token function">getSingleton</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
						<span class="token keyword">try</span> <span class="token punctuation">{</span>
							<span class="token keyword">return</span> <span class="token function">createBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
						
					<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

					beanInstance <span class="token operator">=</span> <span class="token function">getObjectForBeanInstance</span><span class="token punctuation">(</span>sharedInstance<span class="token punctuation">,</span> name<span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mbd<span class="token punctuation">.</span><span class="token function">isPrototype</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// It&#39;s a prototype -&gt; create a new instance.</span>
					<span class="token class-name">Object</span> prototypeInstance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
					<span class="token keyword">try</span> <span class="token punctuation">{</span>
						<span class="token comment">//记录bean开始创建</span>
						<span class="token function">beforePrototypeCreation</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token comment">//多例的原型bean就是直接创建</span>
						prototypeInstance <span class="token operator">=</span> <span class="token function">createBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">finally</span> <span class="token punctuation">{</span>
						<span class="token function">afterPrototypeCreation</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					beanInstance <span class="token operator">=</span> <span class="token function">getObjectForBeanInstance</span><span class="token punctuation">(</span>prototypeInstance<span class="token punctuation">,</span> name<span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token class-name">String</span> scopeName <span class="token operator">=</span> mbd<span class="token punctuation">.</span><span class="token function">getScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					
					<span class="token keyword">try</span> <span class="token punctuation">{</span>  <span class="token comment">// session.getAttriute(beaName)  setAttri</span>
						<span class="token class-name">Object</span> scopedInstance <span class="token operator">=</span> scope<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
							<span class="token function">beforePrototypeCreation</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token keyword">try</span> <span class="token punctuation">{</span>
								<span class="token keyword">return</span> <span class="token function">createBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span>
							<span class="token keyword">finally</span> <span class="token punctuation">{</span>
								<span class="token function">afterPrototypeCreation</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span>
						<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						beanInstance <span class="token operator">=</span> <span class="token function">getObjectForBeanInstance</span><span class="token punctuation">(</span>scopedInstance<span class="token punctuation">,</span> name<span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			
			<span class="token keyword">finally</span> <span class="token punctuation">{</span>
				beanCreation<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 检查通过name所获得到的beanInstance的类型是否是requiredType</span>
		<span class="token keyword">return</span> <span class="token function">adaptBeanInstance</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> beanInstance<span class="token punctuation">,</span> requiredType<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="createbean-加载类" tabindex="-1"><a class="header-anchor" href="#createbean-加载类" aria-hidden="true">#</a> createBean&amp;加载类</h3><p>在AbstractAutowireCapableBeanFactory类的createBean()方法中，一开始就会调用：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> resolvedClass <span class="token operator">=</span> <span class="token function">resolveBeanClass</span><span class="token punctuation">(</span>mbd<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>mbd.hasBeanClass()确保bean是一个class如果不是，就会调用getBeanClass创建class</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>			<span class="token keyword">if</span> <span class="token punctuation">(</span>mbd<span class="token punctuation">.</span><span class="token function">hasBeanClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> mbd<span class="token punctuation">.</span><span class="token function">getBeanClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// 如果beanClass没有被加载</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PrivilegedExceptionAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>
						<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">doResolveBeanClass</span><span class="token punctuation">(</span>mbd<span class="token punctuation">,</span> typesToMatch<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getAccessControlContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token function">doResolveBeanClass</span><span class="token punctuation">(</span>mbd<span class="token punctuation">,</span> typesToMatch<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>会利用BeanFactory所设置的类加载器来加载类，如果没有设置，则默认使用**ClassUtils.getDefaultClassLoader()**所返回的类加载器来加载。</p><p><strong>ClassUtils.getDefaultClassLoader()</strong></p><p>1优先返回当前线程中的ClassLoader</p><p>2线程中类加载器为null的情况下，返回ClassUtils类的类加载器</p><p>3如果ClassUtils类的类加载器为空，那么则表示是Bootstrap类加载器加载的ClassUtils类，那么则返回系统类加载器</p><h3 id="实例化前" tabindex="-1"><a class="header-anchor" href="#实例化前" aria-hidden="true">#</a> 实例化前</h3><p><strong>applyBeanPostProcessorsBeforeInstantiation</strong>会让所有定义的bean都走一遍我们重写的InstantiationAwareBeanPostProcessor接口的方法，</p><p>比如A,实现了InstantiationAwareBeanPostProcessor接口，那么所有的B都会走一遍；</p><p>再比如A实现了这个接口，B也实现了，那么都会走一遍，控制顺序在order方法里，如果A返回了结果那么B就不会走了。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 实例化前 注意如果实例化前返回了bean那么就会用你返回的bean不会往下走了</span>
<span class="token class-name">Object</span> bean <span class="token operator">=</span> <span class="token function">resolveBeforeInstantiation</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbdToUse<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">resolveBeforeInstantiation</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">RootBeanDefinition</span> mbd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Object</span> bean <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span><span class="token constant">FALSE</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>mbd<span class="token punctuation">.</span>beforeInstantiationResolved<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// Make sure bean class is actually resolved at this point.</span>
			<span class="token comment">// synthetic表示合成，如果某些Bean式合成的，那么则不会经过BeanPostProcessor的处理</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mbd<span class="token punctuation">.</span><span class="token function">isSynthetic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">hasInstantiationAwareBeanPostProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> targetType <span class="token operator">=</span> <span class="token function">determineTargetType</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>targetType <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					bean <span class="token operator">=</span> <span class="token function">applyBeanPostProcessorsBeforeInstantiation</span><span class="token punctuation">(</span>targetType<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						bean <span class="token operator">=</span> <span class="token function">applyBeanPostProcessorsAfterInitialization</span><span class="token punctuation">(</span>bean<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			mbd<span class="token punctuation">.</span>beforeInstantiationResolved <span class="token operator">=</span> <span class="token punctuation">(</span>bean <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> bean<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>spring把实现了BeanPostProcessor的bean以及方法都缓存起来，这样就不用每次都要一个一个去实现</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">BeanPostProcessorCache</span> <span class="token punctuation">{</span>

   <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">InstantiationAwareBeanPostProcessor</span><span class="token punctuation">&gt;</span></span> instantiationAware <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SmartInstantiationAwareBeanPostProcessor</span><span class="token punctuation">&gt;</span></span> smartInstantiationAware <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DestructionAwareBeanPostProcessor</span><span class="token punctuation">&gt;</span></span> destructionAware <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MergedBeanDefinitionPostProcessor</span><span class="token punctuation">&gt;</span></span> mergedDefinition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实例化" tabindex="-1"><a class="header-anchor" href="#实例化" aria-hidden="true">#</a> 实例化</h3><p><strong>AbstractAutowireCapableBeanFactory.doCreateBean</strong>方法中：</p><p>方法里面包含了很多，包括通过推断构造方法实例化，@Bean实例化</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 创建Bean实例</span>
			instanceWrapper <span class="token operator">=</span> <span class="token function">createBeanInstance</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实例化后" tabindex="-1"><a class="header-anchor" href="#实例化后" aria-hidden="true">#</a> 实例化后</h3><p>这段代码在<strong>AbstractAutowireCapableBeanFactory.doCreateBean</strong>方法中的populateBean：</p><p>会去调用我们之前缓存起来的InstantiationAwareBeanPostProcessor，用这个bean去做实例化后处理。</p><p>**注意：**实例化之前接受的是Class实例化之后接受的是bean，但是这个bean的属性是没有值的。因为没有做属性注入。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 实例化之后，属性设置之前</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mbd<span class="token punctuation">.</span><span class="token function">isSynthetic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">hasInstantiationAwareBeanPostProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">InstantiationAwareBeanPostProcessor</span> bp <span class="token operator">:</span> <span class="token function">getBeanPostProcessorCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>instantiationAware<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>bp<span class="token punctuation">.</span><span class="token function">postProcessAfterInstantiation</span><span class="token punctuation">(</span>bw<span class="token punctuation">.</span><span class="token function">getWrappedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-属性赋值" tabindex="-1"><a class="header-anchor" href="#_4-属性赋值" aria-hidden="true">#</a> 4.属性赋值</h2><h3 id="spring中过时的bean注入方式" tabindex="-1"><a class="header-anchor" href="#spring中过时的bean注入方式" aria-hidden="true">#</a> spring中过时的Bean注入方式</h3><p><strong>AbstractAutowireCapableBeanFactory.populateBean</strong>方法中</p><p>在实例化后方法走完，会判断你的属性里面是否包含**@Bean(autowire = Autowire.BY_NAME)**如果包含就会走这种过时的注入方法，前提是必须有set方法。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	<span class="token comment">//还可以BY_TYPE，根据类型注入</span>
	<span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>autowire <span class="token operator">=</span> <span class="token class-name">Autowire</span><span class="token punctuation">.</span><span class="token constant">BY_NAME</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">UserService</span> <span class="token function">setUserService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">UserService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>resolvedAutowireMode <span class="token operator">==</span> <span class="token constant">AUTOWIRE_BY_NAME</span> <span class="token operator">||</span> resolvedAutowireMode <span class="token operator">==</span> <span class="token constant">AUTOWIRE_BY_TYPE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// MutablePropertyValues是PropertyValues具体的实现类</span>
   <span class="token class-name">MutablePropertyValues</span> newPvs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutablePropertyValues</span><span class="token punctuation">(</span>pvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// Add property values based on autowire by name if applicable.</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>resolvedAutowireMode <span class="token operator">==</span> <span class="token constant">AUTOWIRE_BY_NAME</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">autowireByName</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> bw<span class="token punctuation">,</span> newPvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token comment">// Add property values based on autowire by type if applicable.</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>resolvedAutowireMode <span class="token operator">==</span> <span class="token constant">AUTOWIRE_BY_TYPE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">autowireByType</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> bw<span class="token punctuation">,</span> newPvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   pvs <span class="token operator">=</span> newPvs<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="-1" tabindex="-1"><a class="header-anchor" href="#-1" aria-hidden="true">#</a></h3><h3 id="依赖注入" tabindex="-1"><a class="header-anchor" href="#依赖注入" aria-hidden="true">#</a> 依赖注入</h3><p><strong>AbstractAutowireCapableBeanFactory.populateBean</strong>方法中：</p><p>这一步会去调用实现了<strong>InstantiationAwareBeanPostProcessor.postProcessProperties</strong>的插件对@Autowire，@Value注解等做属性赋值操作。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	<span class="token class-name">PropertyDescriptor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> filteredPds <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>hasInstAwareBpps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>pvs <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				pvs <span class="token operator">=</span> mbd<span class="token punctuation">.</span><span class="token function">getPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">InstantiationAwareBeanPostProcessor</span> bp <span class="token operator">:</span> <span class="token function">getBeanPostProcessorCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>instantiationAware<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 这里会调用AutowiredAnnotationBeanPostProcessor的postProcessProperties()方法，会直接给对象中的属性赋值</span>
				<span class="token comment">// AutowiredAnnotationBeanPostProcessor内部并不会处理pvs，直接返回了</span>
				<span class="token class-name">PropertyValues</span> pvsToUse <span class="token operator">=</span> bp<span class="token punctuation">.</span><span class="token function">postProcessProperties</span><span class="token punctuation">(</span>pvs<span class="token punctuation">,</span> bw<span class="token punctuation">.</span><span class="token function">getWrappedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>pvsToUse <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>filteredPds <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						filteredPds <span class="token operator">=</span> <span class="token function">filterPropertyDescriptorsForDependencyCheck</span><span class="token punctuation">(</span>bw<span class="token punctuation">,</span> mbd<span class="token punctuation">.</span>allowCaching<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					pvsToUse <span class="token operator">=</span> bp<span class="token punctuation">.</span><span class="token function">postProcessPropertyValues</span><span class="token punctuation">(</span>pvs<span class="token punctuation">,</span> filteredPds<span class="token punctuation">,</span> bw<span class="token punctuation">.</span><span class="token function">getWrappedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>pvsToUse <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">return</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				pvs <span class="token operator">=</span> pvsToUse<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-bean的初始化" tabindex="-1"><a class="header-anchor" href="#_5-bean的初始化" aria-hidden="true">#</a> 5.Bean的初始化</h2><h3 id="初始化前" tabindex="-1"><a class="header-anchor" href="#初始化前" aria-hidden="true">#</a> 初始化前</h3><p>还是<strong>AbstractAutowireCapableBeanFactory.doCreateBean</strong>方法，在走完一些列实例化流程后开始我们的初始化</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>exposedObject <span class="token operator">=</span> <span class="token function">initializeBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> exposedObject<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>首先<strong>invokeAwareMethods</strong>方法会对实现了<strong>BeanNameAware</strong>，<strong>BeanFactoryAware</strong>的方法进行回调。</p><p>再执行初始化前方法。具体的用法我也没了解过。。。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">initializeBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">RootBeanDefinition</span> mbd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
         <span class="token function">invokeAwareMethods</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">getAccessControlContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">invokeAwareMethods</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token class-name">Object</span> wrappedBean <span class="token operator">=</span> bean<span class="token punctuation">;</span>

   <span class="token comment">// 初始化前</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>mbd <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span>mbd<span class="token punctuation">.</span><span class="token function">isSynthetic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wrappedBean <span class="token operator">=</span> <span class="token function">applyBeanPostProcessorsBeforeInitialization</span><span class="token punctuation">(</span>wrappedBean<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token comment">// 初始化</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token function">invokeInitMethods</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> wrappedBean<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanCreationException</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span>mbd <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> mbd<span class="token punctuation">.</span><span class="token function">getResourceDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            beanName<span class="token punctuation">,</span> <span class="token string">&quot;Invocation of init method failed&quot;</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token comment">// 初始化后 AOP</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>mbd <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span>mbd<span class="token punctuation">.</span><span class="token function">isSynthetic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wrappedBean <span class="token operator">=</span> <span class="token function">applyBeanPostProcessorsAfterInitialization</span><span class="token punctuation">(</span>wrappedBean<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">return</span> wrappedBean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="初始化" tabindex="-1"><a class="header-anchor" href="#初始化" aria-hidden="true">#</a> 初始化</h3><p>1查看当前Bean对象是否实现了InitializingBean接口，如果实现了就调用其afterPropertiesSet()方法 2执行BeanDefinition中指定的初始化方法.</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>jprotected <span class="token keyword">void</span> <span class="token function">invokeInitMethods</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">RootBeanDefinition</span> mbd<span class="token punctuation">)</span>
      <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>

   <span class="token keyword">boolean</span> isInitializingBean <span class="token operator">=</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">InitializingBean</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>isInitializingBean <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>mbd <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span>mbd<span class="token punctuation">.</span><span class="token function">isExternallyManagedInitMethod</span><span class="token punctuation">(</span><span class="token string">&quot;afterPropertiesSet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PrivilegedExceptionAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
               <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">InitializingBean</span><span class="token punctuation">)</span> bean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">getAccessControlContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">InitializingBean</span><span class="token punctuation">)</span> bean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span>mbd <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> bean<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token class-name">NullBean</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">String</span> initMethodName <span class="token operator">=</span> mbd<span class="token punctuation">.</span><span class="token function">getInitMethodName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>initMethodName<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
            <span class="token operator">!</span><span class="token punctuation">(</span>isInitializingBean <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;afterPropertiesSet&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>initMethodName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
            <span class="token operator">!</span>mbd<span class="token punctuation">.</span><span class="token function">isExternallyManagedInitMethod</span><span class="token punctuation">(</span>initMethodName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">invokeCustomInitMethod</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> bean<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="初始化后" tabindex="-1"><a class="header-anchor" href="#初始化后" aria-hidden="true">#</a> 初始化后</h3><p>这是Bean创建生命周期中的最后一个步骤，可以在这个步骤中，对Bean最终进行处理，Spring中的AOP就是基于初始化后实现的，初始化后返回的对象才是最终的Bean对象。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 初始化后 AOP</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>mbd <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span>mbd<span class="token punctuation">.</span><span class="token function">isSynthetic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   wrappedBean <span class="token operator">=</span> <span class="token function">applyBeanPostProcessorsAfterInitialization</span><span class="token punctuation">(</span>wrappedBean<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="总结beanpostprocessor" tabindex="-1"><a class="header-anchor" href="#总结beanpostprocessor" aria-hidden="true">#</a> 总结BeanPostProcessor</h3><p>1InstantiationAwareBeanPostProcessor.postProcessBeforeInstantiation() 2实例化 3MergedBeanDefinitionPostProcessor.postProcessMergedBeanDefinition() 4InstantiationAwareBeanPostProcessor.postProcessAfterInstantiation() 5自动注入 6InstantiationAwareBeanPostProcessor.postProcessProperties() 7Aware对象 8BeanPostProcessor.postProcessBeforeInitialization() 9初始化 10BeanPostProcessor.postProcessAfterInitialization()</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/docs/zh/框架系列/spring/生命周期/从源码上浅浅的过一遍Spring生命周期(上).md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: 3245336455@qq.com">yuzien</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">默认页脚</div><div class="vp-copyright">Copyright © 2023 于子恩</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-5f43d021.js" defer></script>
  </body>
</html>
